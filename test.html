<style>
    .ql-editor{
        top: 0%;
        padding-top: 0% !important;
        overflow: hidden;
        width: auto;
        word-break: break-word;
    }

    .ql-editor p {
        margin-top: -7px; 
        margin-bottom: -7px;
    }
    
    .print-format table,
    .print-format tr,
    .print-format td,
    .print-format th,
    .print-format div,
    .print-format p {
        vertical-align: middle;
        font-size: 9pt;
        padding: 1px!important;
    }

    .font-bold tr td{
        font-weight: 600;
    }

    .print-format {
        padding: 0.5cm;
    }
    
    @page {
        size: A4;
        orientation: portrait; 
        margin: 0px 0px 0px 0px !important;
    }

    .print-format th {
        border-bottom: 2px solid !important;
        border-top: 2px solid !important;
        padding: 3px !important;
        background-color: white !important;
    }

    .table-wrapper tr:not(:last-child) > td {
        white-space: normal;
    }

    .table-wrapper tr > td:not(:last-child),
    .table-wrapper tr > th:not(:last-child) {
        border-right: 0px solid;
    }

    .table-wrapper tr > td{
        padding: 0 3px!important;
    }

    .table-wrapper tr > th {
        padding:3px!important;
    }

    table.invoice-info td {
        line-height: 13px;
    }

    .table-wrapper table{
        table-layout: auto;
    }
    .table-wrapper tbody tr td{
        white-space: normal;
        word-break: break-word;
    }
    tfoot {
        display: table-footer-group;
        position: relative;
        bottom: 0;
    }

    .table-header tr td{
        padding: 0px 0px 0px 0px !important;
    }
    
    table tr td{
        white-space: normal;
        word-break: break-word;
    }

    #main-footer div{
        white-space: normal;
        word-break: break-word;
    }
    
    .sign-img {
        filter: brightness(0) saturate(100%) invert(0) contrast(500%);
    }

</style>
{%- if doc.customer_address -%}
    {% set customer_address = (frappe.db.get_value("Address", doc.customer_address, "address_line1") or " ") + " " +
    (frappe.db.get_value("Address", doc.customer_address, "address_line2") or " ")%}

    {% set customer_address2 = (frappe.db.get_value("Address", doc.customer_address, "city") or " " )+ " " +
    (frappe.db.get_value("Address", doc.customer_address, "state") or " ") + " " + (frappe.db.get_value("Address", doc.customer_address, "pincode") or " ") + " " + 
    (frappe.db.get_value("Address", doc.customer_address, "country"))%}
{%- else -%}
    {% set customer_address = "-"%}
    {% set customer_address2 = ""%}
{%- endif -%}

{% set total_PPN = namespace(value= 0) %}
{% set total_PPH = namespace(value= 0) %}

{%- for row_tax in doc.taxes -%}
    {%- if "PPN" in row_tax.account_head or "VAT" in row_tax.account_head -%}
        {% set total_PPN.value = total_PPN.value + row_tax.tax_amount_after_discount_amount %}
    {%- elif "PPh" in row_tax.account_head -%}
        {% set total_PPH.value = total_PPH.value + row_tax.tax_amount_after_discount_amount %}
    {%- endif -%}
{%- endfor -%}

{% set user_now = frappe.db.get_value("User", frappe.session.user, "name")%}

{% set total_row_item = namespace(value= 0) %}

<div class="content-body">
    <script type="text/javascript">
        window.onload = addPageNumbers;

        function addPageNumbers() {
            var content_body_obj = document.getElementById("content-full-body")
            var main_header_obj = document.getElementById("main-header")
            var main_footer_obj = document.getElementById("main-footer")
            var tfoot_obj = document.getElementById("tfoot-content")
            var thead_obj = document.getElementById("thead-content")
            var tbody_obj = document.getElementById('tbody-content')
            var total_height = get_height(main_header_obj) + get_height(thead_obj) + 19 // First page has the thead and main header height, main header is not repeated in 2nd page
            var list_item_row = tbody_obj.querySelectorAll('tr.row-data')
            var page_multiplier = 1
            list_item_row.forEach(function(row,index) {
                // if ((total_height + get_height(row)) > get_body_height()){
                //     page_multiplier = page_multiplier + 1
                //     total_height = get_height(thead_obj) + get_height(row)
                // }
                // If tfoot is not repeated at each page
                if ((total_height + get_height(row)) > get_body_height()){
                    page_multiplier = page_multiplier + 1
                    total_height = get_height(thead_obj) + get_height(tfoot_obj) + get_height(row)
                }
                // if tfoot is repeated at each page
                else{
                    total_height = total_height + get_height(row)
                }
            });
            // if (total_height + get_height(tfoot_obj) +  > get_body_height()){
            //     page_multiplier++
            // }
            // if tfoot is only at last page
            if (total_height + get_height(main_footer_obj) + get_height(tfoot_obj)  > get_body_height()){
                page_multiplier++
            }
            // if tfoot is at each page

            var totalPages = Math.ceil(page_multiplier);  //842px A4 pageheight for 72dpi, 1123px A4 pageheight for 96dpi, 
            // if (content_body_obj.scrollHeight <= get_body_height()){
            //     totalPages = 1
            // }
            for (var i = 1; i <= totalPages; i++) {
                var pageNumberDiv = document.createElement("div");
                var boldcontainer = document.createElement("b")
                var pageNumber = document.createTextNode("Hal. " + i + " dari " + totalPages);
                pageNumberDiv.style.position = "absolute";
                // pageNumberDiv.style.top = "calc((" + i + " * (297mm - 0.5px)) - 860px)"; //297mm A4 pageheight; 0,5px unknown needed necessary correction value; additional wanted 40px margin from bottom(own element height included)
                if (i == 1){
                    pageNumberDiv.style.top = "calc((" + i + " * (297mm - 0.5px)) - 880px)";
                }
                else{
                    pageNumberDiv.style.top = "calc((" + i + " * (297mm - 0.5px)) - 899px)";
                }
                pageNumberDiv.style.height = "10px";
                boldcontainer.appendChild(pageNumber)
                pageNumberDiv.appendChild(boldcontainer);
                document.body.insertBefore(pageNumberDiv, document.getElementById("content"));
                pageNumberDiv.style.left = "calc(100% - (" + pageNumberDiv.offsetWidth + "px + 30px))";
                pageNumberDiv.style.fontSize = "9pt"

                //custom footer
            }
        }

        function get_body_height(){
            // var rect = document.body.getBoundingClientRect()
            // return rect.height
            // return document.body.offsetHeight
            return 1123
        }
        function get_height(element){
            // var rect = element.getBoundingClientRect()
            // return rect.height
            return element.offsetHeight 
        }
    </script>
    <!------- HEADER ------->
    
        <!------- LETTER HEAD ------->
        
   
    <!------- TABLE ------->
    <div class="table-wrapper col-xs-12" style="padding: 0!important;">
        {% if doc.customer == "PT-2024-00322" %}
        <table style="width:100%;top: 0; bottom: 0; left: 0; right: 0;min-height: 950px;">
            <thead id="thead-content">
                {% if doc.workflow_state == "Approved" or user_now == "dwi.sm@intidayads.co.id" %}
                    <tr>
                        <td colspan = "8">
                            <div class="col-xs-12" id="main-header">
                                <div class="text-left" style="width: 100%;float: left;">
                                    <div class="">{{ letter_head }}</div>
                                </div>
                            </div>
                        </td>
                    </tr>
                {% else %}
                    <div class="content-body">
                        <div class=text-center>
                            <h1>HARAP APPROVED SEBELUM PRINT</h1>
                        </div>
                    </div>
                {% endif %}
                <tr>
                    <td colspan = "8" style="border-bottom: 1px solid;">
                        <div class="col-xs-12">
                            <div class="col-xs-5">
                                <table style="width: 100%; height: 100%;">
                                    <tr>
                                        <td> <b>Invoice for :</b> </td>
                                    </tr>
                                    <tr>
                                        <td colspan="2"> 
                                            <span style="white-space: normal;word-break: break-word;">
                                                <b>{{doc.customer_name}}
                                                <br> {{customer_address + customer_address2}}
                                                </b>    
                                            </span>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="col-xs-2 text-center">
                                <h3>Invoice</h3>
                            </div>
                            <div class="col-xs-5">
                                <table style="width: 100%; height: 100%;" class="font-bold">
                                    <tr>
                                        <td> <b>Submit Date</b></td>
                                        <td>
                                            <span>:</span>
                                        </td>
                                        <td style="white-space: normal;word-break: break-word;">
                                            <b>{{frappe.utils.getdate(doc.document_delivered_date).strftime("%d %B %Y") or "-"}}<b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td> <b>Invoice Date</b> </td>
                                        <td>
                                            <span>:</span>
                                        </td>
                                        <td style="white-space: normal;word-break: break-word;">
                                            <b>{{frappe.utils.getdate(doc.posting_date).strftime("%d %B %Y") or "-"}}<b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td> <b>Invoice Number</b> </td>
                                        <td>
                                            <span>:</span>
                                        </td>
                                        <td style="white-space: normal;word-break: break-word;">
                                            <b>{{doc.name or "-"}}<b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td> <b>Currency</b> </td>
                                        <td>
                                            <span>:</span>
                                        </td>
                                        <td style="white-space: normal;word-break: break-word;">
                                            <b>{{doc.currency or "-"}}<b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td> <b>Terms of Payment</b> </td>
                                        <td>
                                            <span>:</span>
                                        </td>
                                        <td style="white-space: normal;word-break: break-word;">
                                            <b>{{doc.payment_terms_template or "-"}}<b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td> <b>Due Date</b> </td>
                                        <td>
                                            <span>:</span>
                                        </td>
                                        <td style="white-space: normal;word-break: break-word;">
                                            <b>{{frappe.utils.getdate(doc.due_date).strftime("%d %B %Y") or "-"}}<b>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td colspan="8" style="height: 15px;">

                    </td>
                </tr>
                <tr>
                    <th class="text-center" style="width: 5%; border-right: 1px solid;border-left: 1px solid;">No.</th>
                    <th class="text-center" style="width: 34%; border-right: 1px solid;">Description</th>
                    <th class="text-center" style="width: 12%; border-right: 1px solid;">Qty</th> 
                    <th colspan="2" class="text-center" style="width: 15%; border-right: 1px solid;">Price/Unit</th>
                    <th class="text-center" style="width: 14.5%; border-right: 1px solid;">Discount</th>
                    <th colspan="2" class="text-center" style="width: 22.5%; border-right: 1px solid;">Amount</th>
                </tr>
            </thead>
            <tbody id="tbody-content" class="font-bold">
                {%- for item in doc.items -%}
                <tr style="height: 20px;" class="row-data">
                    <td class="text-center" style="border-right: 1px solid;border-left: 1px solid;">{{ loop.index }}.</td>
                    <td class="text-left" style="border-right: 1px solid;">
                        {{item.item_name}} <br> {{item.description}}
                    </td>
                    {%- if item.qty_print -%}
                        <td class="text-right" style="border-right: 1px solid;">
                            {%- if item.qty_print == "0" -%}
                                 
                            {%- else -%}
                                {{item.qty_print}}
                            {%- endif -%}
                        </td>
                    {%- else -%}
                        <td class="text-right" style="border-right: 1px solid;">{{ frappe.utils.fmt_money(item.qty, precision = 0)}} {{ item.uom}}</td>
                    {%- endif -%}
                    <td class="text-left">
                        {%- if item.rate_print == "0" -%}
                                 
                        {%- else -%}
                            {{frappe.db.get_value("Currency", doc.currency, "symbol") or "-"}}
                        {%- endif -%}
                        
                    </td>
                    {%- if item.rate_print -%}
                        <td class="text-right" style="border-right: 1px solid;">
                            {%- if item.rate_print == "0" -%}
                                 
                            {%- else -%}
                                {{ frappe.utils.fmt_money(item.rate_print, precision = 0) or " "}}
                            {%- endif -%}  
                        </td>
                    {%- else -%}
                        <td class="text-right" style="border-right: 1px solid;">{{ frappe.utils.fmt_money(item.price_list_rate or item.rate, precision = 0) or " "}}</td>
                    {%- endif -%}
                    {%- if item.discount_on_print -%}
                        <td class="text-right" style="border-right: 1px solid;">
                            {{ frappe.utils.fmt_money( item.discount_on_print, precision = 0) or " "}} %
                        </td>
                    {%- else -%}
                        <td class="text-right" style="border-right: 1px solid;">
                            {%- if item.discount_percentage == 0 -%}
                                
                            {%- else -%}
                                {{ frappe.utils.fmt_money( item.discount_percentage, precision = 0) or " "}} %
                            {%- endif -%}
                            
                        </td>
                    {%- endif -%}
                    <td class="text-left">
                        {%- if item.ammount_on_print == "0" -%}
                                 
                        {%- else -%}
                            {{frappe.db.get_value("Currency", doc.currency, "symbol") or " "}}
                        {%- endif -%}
                        
                    </td>
                    {%- if item.ammount_on_print -%}
                        <td class="text-right" style="border-right: 1px solid;">
                            {%- if item.ammount_on_print == "0" -%}
                                 
                            {%- else -%}
                                {{ frappe.utils.fmt_money(item.ammount_on_print, precision = 0) or " "}}
                            {%- endif -%}
                            
                        </td>
                    {%- else -%}
                        <td class="text-right" style="border-right: 1px solid;">{{ frappe.utils.fmt_money(item.net_amount or 0, precision = 0) or " "}}</td>
                    {%- endif -%}
                </tr>
                {%- endfor -%}
                <tr class="row-data">
                    <td style="border-right: 1px solid;border-left: 1px solid;"></td>
                    <td style="border-right: 1px solid;"></td>
                    <td style="border-right: 1px solid;"></td>
                    <td></td>
                    <td style="border-right: 1px solid;"></td>
                    <td style="border-right: 1px solid;"></td>
                    <td></td>
                    <td style="border-right: 1px solid;"></td>
                </tr>
                <tr class="row-data" style="height: 10px;">
                    <td colspan="5" style="border-top: 1px solid;padding: 0px !important; border-left: 1px solid; border-bottom: 1px solid;">
                        <div class="col-xs-12" style="font-weight: 600">
                            Description : <br> {{"PO No. " + (doc.po_no or "-") }}
                        </div>
                        <div class="col-xs-12" style="font-weight: 600">
                            {{ doc.terms }}
                        </div>
                    </td>
                    <td colspan="3" style="height: 10px;border-top: 1px solid; padding: 0px !important;">
                        <table style="width: 100%; border-bottom: 1px solid; border-left: 1px solid;" class="font-bold">
                            <tr style="width: 100%;">
                                <td class="text-left" style="width: 41%;">Sub Total</td>
                                <td style="width: 10%;border-left: 1px solid;padding-left: 3px !important;">{{frappe.db.get_value("Currency", doc.currency, "symbol") or "-"}}</td>
                                <td class="text-right" style="width: 45%;border-right: 1px solid;">{{frappe.utils.fmt_money(doc.total or 0, precision = 0) or 0}}</td>
                            </tr>
                            <tr>
                                <td class="text-left" >Discount</td>
                                <td style="border-left: 1px solid;padding-left: 3px !important;">{{frappe.db.get_value("Currency", doc.currency, "symbol") or "-"}}</td>
                                <td class="text-right" style="border-right: 1px solid;">{{frappe.utils.fmt_money(doc.discount_amount or 0, precision = 0) or 0}}</td>
                            </tr>
                            <tr>
                                <td class="text-left" >Down Payment</td>
                                <td style="border-left: 1px solid;padding-left: 3px !important;">{{frappe.db.get_value("Currency", doc.currency, "symbol") or "-"}}</td>
                                <td class="text-right" style="border-right: 1px solid;">{{frappe.utils.fmt_money(doc.total_advance or 0, precision = 0) or 0}}</td>
                            </tr>
                            <tr>
                                <td class="text-left" >To be Paid</td>
                                <td style="border-left: 1px solid;padding-left: 3px !important;">{{frappe.db.get_value("Currency", doc.currency, "symbol") or "-"}}</td>
                                <td class="text-right" style="border-right: 1px solid;">{{frappe.utils.fmt_money(((doc.total or 0) - (doc.discount_amount or 0) - (doc.total_advance or 0)) or 0, precision = 0) or 0}}</td>
                            </tr>
                            <tr>
                                <td class="text-left" >PPN</td>
                                <td style="border-left: 1px solid;padding-left: 3px !important;">{{frappe.db.get_value("Currency", doc.currency, "symbol") or "-"}}</td>
                                <td class="text-right" style="border-right: 1px solid;">{{frappe.utils.fmt_money(total_PPN.value or 0, precision = 0) or 0}}</td>
                            </tr>
                            <tr>
                                <td class="text-left" >PPH</td>
                                <td style="border-left: 1px solid;padding-left: 3px !important;">{{frappe.db.get_value("Currency", doc.currency, "symbol") or "-"}}</td>
                                <td class="text-right" style="border-right: 1px solid;">{{frappe.utils.fmt_money(total_PPH.value or 0, precision = 0) or 0}}</td>
                            </tr>
                            <tr>
                                <td class="text-left">Grand Total</td>
                                <td style="border-left: 1px solid;padding-left: 3px !important;">{{frappe.db.get_value("Currency", doc.currency, "symbol") or "-"}}</td>
                                <td class="text-right" style="border-right: 1px solid;">{{frappe.utils.fmt_money(doc.grand_total or 0, precision = 0) or 0}}</td>
                            </tr>
                        </table>
                    </td>
                </tr>
                
                <tr class="row-data" style="height: 10px;">
                    <td colspan="8">
                        <div class="col-xs-8 footer-content" style="margin-top: 8px;">
                            <div class="col-xs-12" style="font-weight: 600">
                                    Money transfer to the account below : <br>
                                    Account Number : {{frappe.db.get_value("Bank Account", {"party" : doc.customer, "party_type": "Customer"}, "bank_account_no") or "-"}}<br>
                                    Bank : {{frappe.db.get_value("Bank Account", {"party" : doc.customer, "party_type": "Customer"}, "bank") or "-"}}<br>
                                    Name : {{frappe.db.get_value("Bank Account", {"party" : doc.customer, "party_type": "Customer"}, "account_name") or "-"}}
                            </div>
                        </div>
                        <div class="col-xs-4 footer-content" style="margin-top: 8px;">
                            <table style="float: left;" class="font-bold">
                                <tr>
                                    <td class="text-center" style="width: 3cm">Best Regards,</td>
                                </tr>
                                <tr>
                                    <td class="text-center" style="width: 4cm"><b>{{get_user_default_company_print_format()}}</b></td>
                                </tr>
                                <tr>
                                    <td class="text-center" style="height: 25mm;">
                                        
                                    </td> 
                                </tr>
                                <tr>
                                    <td class="text-center" style="width: 5cm"><b>Dwi Sawiatun Maijah</b></td>
                                </tr>
                            </table>
                        </div>
                    </td>
                </tr>
            </tbody>
            <tfoot id = "tfoot-content">
                <tr style="height: 10px;">
                    <td colspan="8"> 
                    </td>
                </tr>
            </tfoot>
        </table>
        {% else %}
        <table style="width:100%;top: 0; bottom: 0; left: 0; right: 0;min-height: 950px;">
            <thead id="thead-content">
                {% if doc.workflow_state == "Approved" or user_now == "dwi.sm@intidayads.co.id" %}
                    <tr>
                        <td colspan = "8">
                            <div class="col-xs-12" id="main-header">
                                <div class="text-left" style="width: 100%;float: left;">
                                    <div class="">{{ letter_head }}</div>
                                </div>
                            </div>
                        </td>
                    </tr>
                {% else %}
                    <div class="content-body">
                        <div class=text-center>
                            <h1>HARAP APPROVED SEBELUM PRINT</h1>
                        </div>
                    </div>
                {% endif %}
                <tr>
                    <td colspan = "8" style="border-bottom: 1px solid;">
                        <div class="col-xs-12">
                            <div class="col-xs-5">
                                <table style="width: 100%; height: 100%;">
                                    <tr>
                                        <td> <b>Kepada Yth :</b> </td>
                                    </tr>
                                    <tr>
                                        <td colspan="2"> 
                                            <span style="white-space: normal;word-break: break-word;">
                                                <b>{{doc.customer_name}}
                                                <br> {{customer_address + customer_address2}}
                                                </b>    
                                            </span>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="col-xs-2 text-center">
                                <h3>Invoice</h3>
                            </div>
                            <div class="col-xs-5">
                                <table style="width: 100%; height: 100%;" class="font-bold">
                                    <tr>
                                        <td> <b>Tgl Submit</b></td>
                                        <td>
                                            <span>:</span>
                                        </td>
                                        <td style="white-space: normal;word-break: break-word;">
                                            <b>{{frappe.utils.getdate(doc.document_delivered_date).strftime("%d %B %Y") or "-"}}<b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td> <b>Tgl Faktur</b> </td>
                                        <td>
                                            <span>:</span>
                                        </td>
                                        <td style="white-space: normal;word-break: break-word;">
                                            <b>{{frappe.utils.getdate(doc.posting_date).strftime("%d %B %Y") or "-"}}<b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td> <b>No.Nota</b> </td>
                                        <td>
                                            <span>:</span>
                                        </td>
                                        <td style="white-space: normal;word-break: break-word;">
                                            <b>{{doc.name or "-"}}<b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td> <b>Mata Uang</b> </td>
                                        <td>
                                            <span>:</span>
                                        </td>
                                        <td style="white-space: normal;word-break: break-word;">
                                            <b>{{doc.currency or "-"}}<b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td> <b>Termin</b> </td>
                                        <td>
                                            <span>:</span>
                                        </td>
                                        <td style="white-space: normal;word-break: break-word;">
                                            <b>{{doc.payment_terms_template or "-"}}<b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td> <b>Due Date</b> </td>
                                        <td>
                                            <span>:</span>
                                        </td>
                                        <td style="white-space: normal;word-break: break-word;">
                                            <b>{{frappe.utils.getdate(doc.due_date).strftime("%d %B %Y") or "-"}}<b>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td colspan="8" style="height: 15px;">

                    </td>
                </tr>
                <tr>
                    <th class="text-center" style="width: 5%; border-right: 1px solid;border-left: 1px solid;">No.</th>
                    <th class="text-center" style="width: 34%; border-right: 1px solid;">Description</th>
                    <th class="text-center" style="width: 12%; border-right: 1px solid;">Qty</th> 
                    <th colspan="2" class="text-center" style="width: 15%; border-right: 1px solid;">Harga/Unit</th>
                    <th class="text-center" style="width: 14.5%; border-right: 1px solid;">Discount</th>
                    <th colspan="2" class="text-center" style="width: 22.5%; border-right: 1px solid;">Amount</th>
                </tr>
            </thead>
            <tbody id="tbody-content" class="font-bold">
                {%- for item in doc.items -%}
                <tr style="height: 20px;" class="row-data">
                    <td class="text-center" style="border-right: 1px solid;border-left: 1px solid;">{{ loop.index }}.</td>
                    <td class="text-left" style="border-right: 1px solid;">
                        {{item.item_name}} <br> {{item.description}}
                    </td>
                    {%- if item.qty_print -%}
                        <td class="text-right" style="border-right: 1px solid;">
                            {%- if item.qty_print == "0" -%}
                                 
                            {%- else -%}
                                {{item.qty_print}}
                            {%- endif -%}
                        </td>
                    {%- else -%}
                        <td class="text-right" style="border-right: 1px solid;">{{ frappe.utils.fmt_money(item.qty, precision = 0)}} {{ item.uom}}</td>
                    {%- endif -%}
                    <td class="text-left">
                        {%- if item.rate_print == "0" -%}
                                 
                        {%- else -%}
                            {{frappe.db.get_value("Currency", doc.currency, "symbol") or "-"}}
                        {%- endif -%}
                        
                    </td>
                    {%- if item.rate_print -%}
                        <td class="text-right" style="border-right: 1px solid;">
                            {%- if item.rate_print == "0" -%}
                                 
                            {%- else -%}
                                {{ frappe.utils.fmt_money(item.rate_print, precision = 0) or " "}}
                            {%- endif -%}  
                        </td>
                    {%- else -%}
                        <td class="text-right" style="border-right: 1px solid;">{{ frappe.utils.fmt_money(item.price_list_rate or item.rate, precision = 0) or " "}}</td>
                    {%- endif -%}
                    {%- if item.discount_on_print -%}
                        <td class="text-right" style="border-right: 1px solid;">
                            {{ frappe.utils.fmt_money( item.discount_on_print, precision = 0) or " "}} %
                        </td>
                    {%- else -%}
                        <td class="text-right" style="border-right: 1px solid;">
                            {%- if item.discount_percentage == 0 -%}
                                
                            {%- else -%}
                                {{ frappe.utils.fmt_money( item.discount_percentage, precision = 0) or " "}} %
                            {%- endif -%}
                            
                        </td>
                    {%- endif -%}
                    <td class="text-left">
                        {%- if item.ammount_on_print == "0" -%}
                                 
                        {%- else -%}
                            {{frappe.db.get_value("Currency", doc.currency, "symbol") or " "}}
                        {%- endif -%}
                        
                    </td>
                    {%- if item.ammount_on_print -%}
                        <td class="text-right" style="border-right: 1px solid;">
                            {%- if item.ammount_on_print == "0" -%}
                                 
                            {%- else -%}
                                {{ frappe.utils.fmt_money(item.ammount_on_print, precision = 0) or " "}}
                            {%- endif -%}
                            
                        </td>
                    {%- else -%}
                        <td class="text-right" style="border-right: 1px solid;">{{ frappe.utils.fmt_money(item.net_amount or 0, precision = 0) or " "}}</td>
                    {%- endif -%}
                </tr>
                {%- endfor -%}
                <tr class="row-data">
                    <td style="border-right: 1px solid;border-left: 1px solid;"></td>
                    <td style="border-right: 1px solid;"></td>
                    <td style="border-right: 1px solid;"></td>
                    <td></td>
                    <td style="border-right: 1px solid;"></td>
                    <td style="border-right: 1px solid;"></td>
                    <td></td>
                    <td style="border-right: 1px solid;"></td>
                </tr>
                <tr class="row-data" style="height: 10px;">
                    <td colspan="5" style="border-top: 1px solid;padding: 0px !important; border-left: 1px solid; border-bottom: 1px solid;">
                        <div class="col-xs-12" style="font-weight: 600">
                            Ket : <br> {{"Sesuai PO No. " + (doc.po_no or "-") }}
                        </div>
                        <div class="col-xs-12" style="font-weight: 600">
                            {{ doc.terms }}
                        </div>
                    </td>
                    <td colspan="3" style="height: 10px;border-top: 1px solid; padding: 0px !important;">
                        <table style="width: 100%; border-bottom: 1px solid; border-left: 1px solid;" class="font-bold">
                            <tr style="width: 100%;">
                                <td class="text-left" style="width: 41%;">Sub Total</td>
                                <td style="width: 10%;border-left: 1px solid;padding-left: 3px !important;">{{frappe.db.get_value("Currency", doc.currency, "symbol") or "-"}}</td>
                                <td class="text-right" style="width: 45%;border-right: 1px solid;">{{frappe.utils.fmt_money(doc.total or 0, precision = 0) or 0}}</td>
                            </tr>
                            <tr>
                                <td class="text-left" >Diskon</td>
                                <td style="border-left: 1px solid;padding-left: 3px !important;">{{frappe.db.get_value("Currency", doc.currency, "symbol") or "-"}}</td>
                                <td class="text-right" style="border-right: 1px solid;">{{frappe.utils.fmt_money(doc.discount_amount or 0, precision = 0) or 0}}</td>
                            </tr>
                            <tr>
                                <td class="text-left" >Uang Muka</td>
                                <td style="border-left: 1px solid;padding-left: 3px !important;">{{frappe.db.get_value("Currency", doc.currency, "symbol") or "-"}}</td>
                                <td class="text-right" style="border-right: 1px solid;">{{frappe.utils.fmt_money(doc.total_advance or 0, precision = 0) or 0}}</td>
                            </tr>
                            <tr>
                                <td class="text-left" >Pelunasan</td>
                                <td style="border-left: 1px solid;padding-left: 3px !important;">{{frappe.db.get_value("Currency", doc.currency, "symbol") or "-"}}</td>
                                <td class="text-right" style="border-right: 1px solid;">{{frappe.utils.fmt_money(((doc.total or 0) - (doc.discount_amount or 0) - (doc.total_advance or 0)) or 0, precision = 0) or 0}}</td>
                            </tr>
                            <tr>
                                <td class="text-left" >PPN</td>
                                <td style="border-left: 1px solid;padding-left: 3px !important;">{{frappe.db.get_value("Currency", doc.currency, "symbol") or "-"}}</td>
                                <td class="text-right" style="border-right: 1px solid;">{{frappe.utils.fmt_money(total_PPN.value or 0, precision = 0) or 0}}</td>
                            </tr>
                            <tr>
                                <td class="text-left" >PPH</td>
                                <td style="border-left: 1px solid;padding-left: 3px !important;">{{frappe.db.get_value("Currency", doc.currency, "symbol") or "-"}}</td>
                                <td class="text-right" style="border-right: 1px solid;">{{frappe.utils.fmt_money(total_PPH.value or 0, precision = 0) or 0}}</td>
                            </tr>
                            <tr>
                                <td class="text-left">Grand Total</td>
                                <td style="border-left: 1px solid;padding-left: 3px !important;">{{frappe.db.get_value("Currency", doc.currency, "symbol") or "-"}}</td>
                                <td class="text-right" style="border-right: 1px solid;">{{frappe.utils.fmt_money(doc.grand_total or 0, precision = 0) or 0}}</td>
                            </tr>
                        </table>
                    </td>
                </tr>
                
                <tr class="row-data" style="height: 10px;">
                    <td colspan="8">
                        <div class="col-xs-8 footer-content" style="margin-top: 8px;">
                            <div class="col-xs-12" style="font-weight: 600">
                                    Alamat Pembayaran Sesuai dengan : <br>
                                    Nomor Rekening : {{frappe.db.get_value("Bank Account", {"party" : doc.customer, "party_type": "Customer"}, "bank_account_no") or "-"}}<br>
                                    Nama Bank : {{frappe.db.get_value("Bank Account", {"party" : doc.customer, "party_type": "Customer"}, "bank") or "-"}}<br>
                                    Atas Nama : {{frappe.db.get_value("Bank Account", {"party" : doc.customer, "party_type": "Customer"}, "account_name") or "-"}}
                           
                            </div>
                        </div>
                        <div class="col-xs-4 footer-content" style="margin-top: 8px;">
                            <table style="float: left;" class="font-bold">
                                <tr>
                                    <td class="text-center" style="width: 3cm">Hormat Kami,</td>
                                </tr>
                                <tr>
                                    <td class="text-center" style="width: 4cm"><b>{{get_user_default_company_print_format()}}</b></td>
                                </tr>
                                <tr>
                                    <td class="text-center" style="height: 25mm;">
                                        
                                    </td> 
                                </tr>
                                <tr>
                                    <td class="text-center" style="width: 5cm"><b>Dwi Sawiatun Maijah</b></td>
                                </tr>
                            </table>
                        </div>
                    </td>
                </tr>
            </tbody>
            <tfoot id = "tfoot-content">
                <tr style="height: 10px;">
                    <td colspan="8"> 
                    </td>
                </tr>
            </tfoot>
        </table>
        {% endif %}
    </div>
    <!------- FOOTER ------->
    <div class="col-xs-12" id = "main-footer">
    
    </div>
</div>

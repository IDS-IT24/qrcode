<style>
    .ql-editor{
        top: 0%;
        padding-top: 0% !important;
        overflow: hidden;
        float: left;
        width: auto;
        word-break: break-word;
    }
    
    .print-format table,
    .print-format tr,
    .print-format td,
    .print-format th,
    .print-format div,
    .print-format p {
        vertical-align: middle;
        font-size: 9pt;
        padding: 1px!important;
    }

    .print-format {
        padding: 0.5cm;
    }
    
    @page {
        size: A4;
        orientation: portrait;
        margin: 0 !important;}

    .print-format th {
        border-bottom: 1px solid !important;
        padding: 3px !important;
        background-color: white !important;
    }
/* 
    .table-wrapper tr:not(:last-child) > td {
        white-space: nowrap;
    } */

    .table-wrapper tr > td:not(:last-child),
    .table-wrapper tr > th:not(:last-child) {
        border-right: 1px solid;
    }

    .table-wrapper tr > td{
        padding: 0 3px!important;
    }

    .table-wrapper tr > th {
        padding:3px!important;
    }

    table.invoice-info td {
        line-height: 13px;
    }

    .table-wrapper table{
        table-layout: auto;
    }

    .table-wrapper tbody tr td{
        white-space: normal;
        word-break: break-word;
    }
    tfoot {
        display: table-footer-group;
        position: relative;
        bottom: 0;
    }

    .table-header tr td{
        padding: 0px 0px 0px 0px !important;
    }
    
    table tr td{
        white-space: normal;
        word-break: break-word;
    }

    #main-footer div{
        white-space: normal;
        word-break: break-word;
    }
</style>

{%- if doc.customer_address -%}
    {% set customer_address = (frappe.db.get_value("Address", doc.customer_address, "address_line1") or " ") + " " +
    (frappe.db.get_value("Address", doc.customer_address, "address_line2") or " ")%}

    {% set customer_address2 = (frappe.db.get_value("Address", doc.customer_address, "city") or " " )+ " " +
    (frappe.db.get_value("Address", doc.customer_address, "state") or " ") + " " +
    (frappe.db.get_value("Address", doc.customer_address, "country"))%}
{%- else -%}
    {% set customer_address = "-"%}
    {% set customer_address2 = ""%}
{%- endif -%}

{% set item_unit = namespace(value= {}) %}
{% set index_item_unit = namespace(value= -1) %}
{% set arr_item_stock_entry = namespace(value= []) %}

{%- for item in doc.items -%}
    {%- if frappe.db.get_value("Item", item.item_code, "is_unit_item") -%}
        {% set item_unit.value = item %}
        {% set index_item_unit.value = item.idx - 1 %}
    {%- endif -%}
{%- endfor -%}

{% set total_row_item = namespace(value= 0) %}

{% if doc.workflow_state != "Approved" %}
<div class="content-body">
    <div class="d-flex justify-content-center">
        <h1>STATUS DOCUMENT: {{doc.workflow_state}}</h1>
        <h1>HARAP DIAPPROVE SEBELUM PRINT !!!</h1>
    </div>
</div>
{% else %}
<div class="content-body">
    <!------- HEADER ------->
    <!------- TABLE ------->
    <div class="table-wrapper col-xs-12" style="padding: 0!important; margin-bottom: 0.5cm;">
        <table style="width:100%;min-height: 850px;border:1px solid">
            <thead>
                <tr>
                    <td colspan="8">
                        <div class="col-xs-12" style="margin-bottom: 10px;">
                            <div class="col-xs-5">
                                <span style="font-size: 18pt;border-bottom: 1px solid;padding-bottom: 5px !important;"><b>Material Transfer</b></span>
                            </div>
                            <div class="col-xs-2">
                    
                            </div>
                            <div class="col-xs-5" style="float: right;">
                                <table style="width: 100%; height: 100%;border: 1px solid;">
                                    <tr>
                                        <td style="width: 30%; border-left: none !important; border-right: none !important;"> <b>Release No.</b></td>
                                        <td style="width: 2%;">
                                            <span>:</span>
                                        </td>
                                        <td>
                                            <b>{{doc.name}}<b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="border-right: none !important;"> <b>Release Date</b> </td>
                                        <td>
                                            <span>:</span>
                                        </td>
                                        <td>
                                            <b>{{frappe.utils.format_datetime(doc.posting_date, "dd/MM/yyyy ") or "-"}}<b>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th colspan="8">
                        <table style="width: 100%; height: 100%;" style="margin-bottom: 7px !important;">
                            <tr>
                                <td style="width: 15%; border: 0px;"> <b>Description</b></td>
                                <td style="width: 2%; border: 0px;">
                                    <span>:</span>
                                </td>
                                <td>
                                    <b>{{frappe.db.get_value("Surat Perintah Kerja", doc.surat_perintah_kerja, "reference_sales_order") or ""}} - {{ frappe.db.get_value("Sales Order", frappe.db.get_value("Surat Perintah Kerja", doc.surat_perintah_kerja, "reference_sales_order"), "customer_name") or ""}} - Unit {{item_unit.value.item_code or ""}} {{item_unit.value.serial_no or ""}}<b>
                                </td>
                            </tr>
                            <tr>
                                <td style="border: 0px;"> <b>Work Order No.</b> </td>
                                <td style="border: 0px;">
                                    <span>:</span>
                                </td>
                                <td>
                                    <b>{{doc.surat_perintah_kerja or "-"}}<b>
                                </td>
                            </tr>
                            <tr>
                                <td style="border: 0px;"> <b>Departement</b></td>
                                <td style="border: 0px;">
                                    <span>:</span>
                                </td>
                                <td>
                                    <b>{{doc.department or "-"}}<b>
                                </td>
                            </tr>
                            <tr>
                                <td style="border: 0px;"> <b>Project No.</b></td>
                                <td style="border: 0px;">
                                    <span>:</span>
                                </td>
                                <td>
                                    <b>{{doc.project or "-"}}<b>
                                </td>
                            </tr>
                            
                        </table>
                    </th>
                </tr>
                <tr>
                    <th class="text-center" style="width: 4%;">NO</th>
                    <th class="text-center" style="width: 15%;">Item Code</th>
                    <th class="text-center" style="width: 20%;">Item Description</th>
                    <th class="text-center" style="width: 7%;">Qty</th>
                    <th class="text-center" style="width: 7%;">Unit</th>
                    <th class="text-center" style="width: 16%;">From</th>
                    <th class="text-center" style="width: 16%;">To</th>
                    <th class="text-center" style="width: 15%;">Notes</th>
                </tr>
            </thead>
            <tbody>
                {%- for item in doc.items -%}
                <tr style="height: 10px;">
                    <td class="text-right">{{ loop.index }}</td>
                    <td >{{item.item_code}}</td>
                    <td class="text-left" >{{ item.item_name}}</td> 
                    <td class="text-right" >{{ frappe.utils.fmt_money(item.qty, precision = 2)}}</td>
                    <td class="text-left" >{{ item.uom }}</td>
                    <td class="text-left" >{{ item.s_warehouse}}</td>
                    <td class="text-left" >{{ item.t_warehouse}}</td>
                    <td class="text-left" >{{ item.note or ""}}</td>
                </tr>
                {%- endfor -%}
                <tr>
                    <td >&nbsp;</td>
                    <td >&nbsp;</td>
                    <td >&nbsp;</td>
                    <td >&nbsp;</td>
                    <td >&nbsp;</td>
                    <td >&nbsp;</td>
                    <td >&nbsp;</td>
                    <td >&nbsp;</td>
                </tr>
            </tbody>
        </table>
    </div>
    <!------- FOOTER ------->
    <div style="padding: 0!important;" id="main-footer">
        <div style="min-height: 150px;max-height: 150px; padding-top: 10px;">
            <div style="margin-left: 70px;top: 15px;float: left;">
                <table class="width: 100%;">
                    <tr><td class="text-center" style="width: 3cm">Released by,</td></tr>
                    {%- if doc.stock_entry_type != "Material Receipt"-%}
                    <tr>
                        <td class="text-center" style="height: 2.5cm; border-bottom: 1pt solid black;">
                            
                        </td> 
                    </tr>
                    <tr>
                        <td class="text-center">
                            
                        </td>
                    </tr>
                    {%- else -%}
                    <tr>
                        <td class="text-center" style="height: 2.5cm; border-bottom: 1pt solid black;">
                            
                        </td> 
                    </tr>
                    <tr>
                        <td class="text-center" style="border-bottom: 1px;">
                            
                        </td>
                    </tr>
                    {%- endif -%}
                </table>
            </div>
            <div style="margin-left: 70px;top: 15px;float: left;">
                <table class="width: 100%;">
                    <tr><td class="text-center" style="width: 3cm">Received by,</td></tr>
                    {%- if doc.stock_entry_type == "Material Receipt"-%}
                    <tr>
                        <td class="text-center" style="height: 2.5cm; border-bottom: 1pt solid black;">
                            
                        </td> 
                    </tr>
                    <tr>
                        <td class="text-center">
                            
                        </td>
                    </tr>
                    {%- else -%}
                    <tr>
                        <td class="text-center" style="height: 2.5cm; border-bottom: 1pt solid black;">
                            
                        </td> 
                    </tr>
                    <tr>
                        <td class="text-center">
                            
                        </td>
                    </tr>
                    {%- endif -%}
                </table>
            </div>
        </div>
    </div>
</div>
{%- endif -%}